{"version":3,"sources":["geildankevr-core.js","geildankevr-content.js","geildankevr-content-assets.js","geildankevr-content-gallery.js","geildankevr-content-single.js","geildankevr-globalevents.js","geildankevr-mobiledetection.js","geildankevr-stage.js","geildankevr-utils.js"],"names":["window","GEILDANKEVR","SCOPE","single","config","isValid","stage","container","utils","errorChecker","init","content","gallery","singles","remove","cancelRenderLoop","destroyScene","destroy","contentType","createObjects","assets","getIconPlayWhite","createAnimationCrosshairRaycaster","createAnimationPointerRaycaster","createContent","createCrosshair","createHouse","createNavigation","createPlane","createRaycaster","createRoom","createSIF","createSingleThumb","createTerrain","createTexture","createTree","createWallWithWindow","createWorld","crosshair","endThumbAnimation","handleIntersection","startThumbAnimation","thumbsContainer","defaults","color","idle","error","geometry","material","sif","THREE","PlaneGeometry","MeshPhongMaterial","shading","FlatShading","shininess","transparent","opacity","Mesh","state","mode","direction","sign","rotation","y","Math","PI","name","setMode","allowedModes","modeSetup","indexOf","scroll","Color","camera","RingGeometry","MeshBasicMaterial","side","DoubleSide","mouse3d","getMouse3d","getStage","position","x","z","mobileDetection","isMobile","add","registerAnimation","set","scene","intersects","delay","i","max","length","element","handleLookat","lookAt","lookAtArguments","object","lookAway","lookAwayArguments","house","wallLeft","wallRight","wallGeometry","wallMaterial","BoxGeometry","MeshLambertMaterial","receiveShadow","Object3D","objects","plane","planeGeometry","planeMaterial","CylinderGeometry","cone","coneGeometry","coneMaterial","crownHeight","crownWidth","cylinder","cylinderGeometry","cylinderMaterial","stemHeight","stemWidth","getRandomGauss","random","castShadow","environment","tree","getRandomInteger","currentlyIntersecting","raycaster","Raycaster","origin","getWorldPosition","getWorldDirection","intersectObjects","setFromCamera","getMouse2d","galleryWall","minOffset","spaceBetweenThumbs","thumbWidth","params","scrollOffset","current","min","buttonGroup","buttonLeft","buttonRight","index","count","mesh","texture","xOffset","url","map","fit","repeatX","repeatY","TextureLoader","load","image","naturalHeight","naturalWidth","repeat","offset","wrapT","RepeatWrapping","wrapS","ClampToEdgeWrapping","wallWidth","windowWidth","glassPane","sideWidth","transparentMaterial","wall","objectGroup","floor","wall1","wall2","wall3","lights","sky","wallMesh","BackSide","fog","PointLight","AmbientLight","deregisterAnimation","speed","ui","world","Fog","DEFAULT_ANIMATION_SPEED","VIDEO_PLAY_BUTTON_ID","addVideoPlayButton","createVRSphere","createVideo","createVideoPlayHandling","createVideoSources","endAnimation","handleOptionalAnimationSpeed","handleOptionalClearColor","handleOptionalConfig","handleOptionalIsAnimation","handleOptionalStartRotation","handleOptionalVideoMute","handleOptionalVideoPoster","handleVrDisplayModeChange","removeVideo","removeVideoPlayButton","startAnimation","video","videoMaterial","videoTexture","button","videoPlayIcon","document","createElement","setAttribute","style","backgroundImage","backgroundColor","backgroundSize","backgroundPosition","backgroundRepeat","display","top","left","transform","width","height","appendChild","sources","type","SphereGeometry","loop","optionalConfig","VideoTexture","minFilter","NearestFilter","maxFilter","format","RGBFormat","generateMipmaps","scale","addEventListener","play","Object","keys","forEach","key","obj","sourceElement","texturePath","vrSphere","animationSpeed","animationSpeedDPS","clearColor","toString","setClearColor","isAnimation","getVrDisplayMode","startRotation","setLookAt","videoMuted","muted","videoPoster","pause","src","dispose","getElementById","parentNode","removeChild","clock","delta","dolly","getDelta","mediaObject","mediaType","layers","enable","e","globalEvents","handleVrDisplayChange","detail","vrdisplay","isPresenting","setVrDisplayMode","check","a","test","substr","navigator","userAgent","vendor","opera","DEFAULT_COLOR_CLEAR","addListeners","animate","createCamera","createCameraDolly","createControls","createRenderer","createScene","createVREffect","createVRManager","getCurrentContainerDimensions","makeContainerFullscreen","onFullscreenChange","onFullscreenEnd","onFullscreenStart","onResize","prepareDocument","requestAnimationFrameId","setCanvasDimensions","undoContainerFullscreen","updateQueue","effect","fullscreenEvents","bind","isFullscreen","timestamp","controls","manager","update","render","requestAnimationFrame","cameraContainer","containerRatio","offsetWidth","offsetHeight","PerspectiveCamera","Group","VRControls","standing","renderer","WebGLRenderer","antialias","setPixelRatio","devicePixelRatio","shadowMap","enabled","PCFSoftShadowMap","Scene","VREffect","setSize","hideButton","isUndistorted","WebVRManager","dimensions","isLandscapeMode","screen","isPortraitMode","paddingBottom","zIndex","aspect","updateProjectionMatrix","body","canvas","getElementsByTagName","removeProperty","cancelAnimationFrame","Clock","domElement","guid","callback","yRotationDegree","yRotationRadian","degreeToRadians","createCrosshairRaycaster","createPointerRaycaster","getOrientation","isVrDisplayMode","mouse2d","Vector2","Vector3","onMouseMove","delayTimeout","lookatIntervalId","setInterval","intersectObject","clearTimeout","clearInterval","orientation","mozOrientation","msOrientation","event","offsetX","getElementPosition","offsetY","viewHeight","getCanvasDimensions","viewWidth","preventDefault","clientX","clientY","unproject","degrees","Error","clientWidth","clientHeight","el","rect","getBoundingClientRect","scrollLeft","scrollTop","pageXOffset","documentElement","pageYOffset","median","variance","cove","pow","fullscreen","webkitFullscreenElement","mozFullScreenElement","setTimeout"],"mappings":"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","file":"geildankevr.js","sourcesContent":["'use strict';\n\nwindow.GEILDANKEVR = (function () {\n  let SCOPE = {};\n\n  /**\n   * Creates a stage and its content for a single full canvas 360 degree video or image.\n   * @param { object } config { mediaType: '', url: '', container: {elementObject} }\n   * @return { void }\n   */\n  SCOPE.single = function (config) {\n    let isValid = false,\n      stage = {};\n\n    isValid = typeof config.container === 'object' &&\n      typeof config === 'object';\n\n    GEILDANKEVR.utils.errorChecker(isValid);\n\n    stage = GEILDANKEVR.stage.init(config.container);\n    GEILDANKEVR.content.init('single', stage, config);\n  };\n\n  /**\n   * Creates a stage and its content for a vr gallery view.\n   * @param  { object } config { container: {elementObject}, singles: [{mediaType: '', url: ''}] }\n   * @return { void }\n   */\n  SCOPE.gallery = function (config) {\n    let isValid = false,\n      stage = {};\n\n    isValid = typeof config.container === 'object' &&\n      typeof config.singles === 'object';\n\n    GEILDANKEVR.utils.errorChecker(isValid);\n\n    stage = GEILDANKEVR.stage.init(config.container);\n    GEILDANKEVR.content.init('gallery', stage, config);\n  };\n\n  /**\n   * Cancels request animation frame\n   * @return { void }\n   */\n  SCOPE.remove = function () {\n    GEILDANKEVR.stage.cancelRenderLoop();\n    GEILDANKEVR.stage.destroyScene();\n    GEILDANKEVR.content.single.destroy();\n  };\n\n  return SCOPE;\n}());\n","'use strict';\n\nwindow.GEILDANKEVR.content = (function () {\n  let SCOPE = {};\n\n  /**\n   * Creates the content for a stage, e.g.\n   * - single image\n   * - single video\n   * - gallery\n   * @param  { string } contentType 'single' or 'gallery'\n   * @param  { object } stage {camera: {}, controls: {}, manager: {}, scene: {}}\n   * @param  { object } config { mediaType: '', url: '', container: {elementObject} }\n   * @return { void }\n   */\n  SCOPE.init = function (contentType, stage, config) {\n    let createObjects;\n\n    createObjects = {\n      single: function () {\n        GEILDANKEVR.content.single.init(stage, config);\n      },\n      gallery: function () {\n        GEILDANKEVR.content.gallery.init(stage, config);\n      }\n    };\n\n    createObjects[contentType]();\n  };\n\n  return SCOPE;\n}());\n","'use strict';\n\nwindow.GEILDANKEVR.assets = (function () {\n  let SCOPE = {};\n\n  /**\n   * Returns the data URI of a white play icon\n   * @return { string } data uri string\n   */\n  SCOPE.getIconPlayWhite = function () {\n    /* eslint-disable max-len */\n    return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAABl0lEQVR4Ae2XveraUBiHY4xD3URx8F+9gHZW9EKEOgi9Cz8uQFtXiwRsobvgIoLXIfYCKrqoaadCk+Xp4HiSc15PQkvB512FB37xvB/Ok/8BXDqMWXMgICIi4MCaEW1cHFOZftBgxpkkTnygbi+osiTCRIhPxUbQ5wdSAnqPCQp84VF8PKmgyA4bthQlggI7bNnimQWfSYNvEvRJyzudoMpP0nKjnCxYkgWLJEFD+6ze8wsZIS/xghk6HN7wDRnTOIHLGR33F/IVCUdyqqCDHudewqhaqmAsEwijGqqCtUwgjGqlCg4ygTCqvSoIZAJhVFdVEMkEwqjCvyiwj+gt8oiy/8j/4G86QosSjZ6BKmhn2iqaqsDllFmz+x7X7Bw+ouMejYxJ/DyoZzRwflNLGpk+WTBPnskVAtJyoaRbW3qkpWtavHzS8Mm82XlssWVDXrb82ik2vJKu7x6+RTj5xw6QHjekXOjanFBlFoSCZzWnZH8EvmbKUdNzJtQER6ChXFoMWbHnSkjIlT0rBjTJyc/Y7OspkNYf1H6eRU02jH0AAAAASUVORK5CYII=';\n    /* eslint-enable max-len */\n  };\n\n  return SCOPE;\n}());\n","'use strict';\n\nwindow.GEILDANKEVR.content.gallery = (function () {\n  let SCOPE = {},\n    createAnimationCrosshairRaycaster = {},\n    createAnimationPointerRaycaster = {},\n    createContent = {},\n    createCrosshair = {},\n    createHouse = {},\n    createNavigation = {},\n    createPlane = {},\n    createRaycaster = {},\n    createRoom = {},\n    createSIF = {},\n    createSingleThumb = {},\n    createTerrain = {},\n    createTexture = {},\n    createTree = {},\n    createWallWithWindow = {},\n    createWorld = {},\n    crosshair = {},\n    endThumbAnimation = {},\n    handleIntersection = {},\n    startThumbAnimation = {},\n    thumbsContainer = {};\n\n  /**\n   * Creates new SIF based on direction set in the config\n   * @param  { object } config { direction: 'left|right' }\n   * @return { object } Mesh that represents SIF\n   */\n  createSIF = function (config) {\n    let defaults = {\n        color: {\n          idle: 0x21b6a8,\n          error: 0xee1515\n        }\n      },\n      geometry = {},\n      material = {},\n      sif = {};\n\n    geometry = new THREE.PlaneGeometry(0.8, 3);\n    material = new THREE.MeshPhongMaterial({\n      color: defaults.color.idle,\n      shading: THREE.FlatShading,\n      shininess: 60,\n      transparent: true,\n      opacity: 0.2\n    });\n\n    sif = new THREE.Mesh(geometry, material);\n\n    sif.state = {\n      mode: 'idle'\n    };\n\n    if (config.direction === 'right') {\n      sif.sign = 1;\n    } else {\n      sif.sign = -1;\n    }\n\n    sif.rotation.y = -Math.PI / 2 * sif.sign;\n    sif.name = config.name;\n\n    sif.setMode = function (mode) {\n      let allowedModes = ['scroll', 'error', 'idle'],\n        modeSetup = {};\n\n      if (this.state.mode === mode || allowedModes.indexOf(mode) < 0) {\n        return;\n      }\n\n      this.state.mode = mode;\n\n      modeSetup = {\n        scroll: {\n          opacity: 0.6,\n          color: new THREE.Color(defaults.color.idle)\n        },\n        idle: {\n          opacity: 0.2,\n          color: new THREE.Color(defaults.color.idle)\n        },\n        error: {\n          opacity: 0.6,\n          color: new THREE.Color(defaults.color.error)\n        }\n      };\n\n      this.material.opacity = modeSetup[mode].opacity;\n      this.material.color = modeSetup[mode].color;\n    };\n\n    return sif;\n  };\n\n  /**\n   * Creates crosshair for the camera\n   * @return { void }\n   */\n  createCrosshair = function () {\n    let camera,\n      geometry = new THREE.RingGeometry(0.001, 0.002, 16),\n      material = new THREE.MeshBasicMaterial({ color: 0xAAFFAA, side: THREE.DoubleSide }),\n      mouse3d = GEILDANKEVR.utils.getMouse3d();\n\n    camera = GEILDANKEVR.stage.getStage().camera;\n    crosshair = new THREE.Mesh(geometry, material);\n\n    crosshair.position.x = 0;\n    crosshair.position.y = 0;\n    crosshair.position.z = -0.2;\n\n    if (GEILDANKEVR.mobileDetection.isMobile() === true) {\n      camera.add(crosshair);\n    } else {\n      GEILDANKEVR.stage.registerAnimation('CROSSHAIR_POINTER', () => {\n        crosshair.position.set(mouse3d.x, mouse3d.y, mouse3d.z);\n        GEILDANKEVR.stage.getStage().scene.add(crosshair);\n      });\n    }\n  };\n\n  /**\n   * Handle intersection with set objects\n   * @param  { array } intersects array representing objects that are being intersected\n   * @param { number } delay before triggering the start animation function\n   * @return { void }\n   */\n  handleIntersection = function (intersects, delay) {\n    for (let i = 0, max = intersects.length; i < max; i = i + 1) {\n      let element = intersects[ i ];\n\n      GEILDANKEVR.utils.handleLookat({\n        element: element,\n        lookAt: startThumbAnimation,\n        lookAtArguments: {\n          sign: element.object.sign,\n          object: element.object\n        },\n        lookAway: endThumbAnimation,\n        lookAwayArguments: {\n          sign: element.object.sign,\n          object: element.object\n        },\n        delay: delay\n      });\n    }\n  };\n\n  /**\n   * Creates a house around the gallery room\n   * @return { void }\n   */\n  createHouse = function () {\n    let house = {},\n      wallLeft = {},\n      wallRight = {},\n      wallGeometry = {},\n      wallMaterial = {};\n\n    wallGeometry = new THREE.BoxGeometry(40, 4, 10);\n    wallMaterial = new THREE.MeshLambertMaterial({\n      color: 0xf7f7f7\n    });\n\n    wallLeft = new THREE.Mesh(wallGeometry, wallMaterial);\n    wallLeft.receiveShadow = true;\n    wallLeft.position.x = 25;\n    wallLeft.position.y = 2;\n    wallLeft.position.z = -7;\n\n    wallRight = new THREE.Mesh(wallGeometry, wallMaterial);\n    wallRight.receiveShadow = true;\n    wallRight.position.x = -25;\n    wallRight.position.y = 2;\n    wallRight.position.z = -7;\n\n    house = new THREE.Object3D();\n    house.add(wallLeft, wallRight);\n    \n    return house;\n  };\n\n  /**\n   * Creates camera raycaster and registers it to detect intersection with set objects\n   * @param  { array } objects array representing objects that react to gaze\n   * @return { void }\n   */\n  createRaycaster = function (objects) {\n    if (GEILDANKEVR.mobileDetection &&\n        GEILDANKEVR.mobileDetection.isMobile() === true) {\n      createAnimationCrosshairRaycaster(objects);\n    } else {\n      createAnimationPointerRaycaster(objects);\n    }\n  };\n\n  /**\n   * Creates a plane below the gallery room holding the environment\n   * @return { void }\n   */\n  createPlane = function () {\n    let plane = {},\n      planeGeometry = {},\n      planeMaterial = {};\n\n    planeGeometry = new THREE.CylinderGeometry(1000, 1000, 1, 100);\n    planeMaterial = new THREE.MeshLambertMaterial({\n      color: 0x596c6a\n    });\n    plane = new THREE.Mesh(planeGeometry, planeMaterial);\n    plane.receiveShadow = true;\n    plane.position.y = -0.1;\n\n    return plane;\n  };\n\n  /**\n   * Creates a single tree\n   * @param { number } x integer value of tree's position\n   * @param { number } z integer value of tree's position\n   * @return { object } tree mesh object\n   */\n  createTree = function (x, z) {\n    let cone = {},\n      coneGeometry = {},\n      coneMaterial = {},\n      crownHeight = 0,\n      crownWidth = 0,\n      cylinder = {},\n      cylinderGeometry = {},\n      cylinderMaterial = {},\n      stemHeight = 0,\n      stemWidth = 0;\n\n    crownHeight = GEILDANKEVR.utils.getRandomGauss(4, 8, 1);\n    crownWidth = crownHeight * (Math.random() * 0.21 + 0.3);\n    stemHeight = crownHeight * 0.25;\n    stemWidth = stemHeight * 0.3;\n\n    coneGeometry = new THREE.CylinderGeometry(0, crownWidth, crownHeight, 8);\n    coneMaterial = new THREE.MeshLambertMaterial({\n      color: 0x4db6ac,\n      shading: THREE.FlatShading\n    });\n    cone = new THREE.Mesh(coneGeometry, coneMaterial);\n    cone.position.set(x, crownHeight * 0.5 + stemHeight, z);\n\n    cylinderGeometry = new THREE.CylinderGeometry(stemWidth, stemWidth, stemHeight, 5);\n    cylinderMaterial = new THREE.MeshLambertMaterial({\n      color: 0x5D4037\n    });\n    cylinder = new THREE.Mesh(cylinderGeometry, cylinderMaterial);\n    cylinder.position.set(0, -stemHeight * 2.5, 0);\n\n    cone.add(cylinder);\n    cone.castShadow = true;\n    cone.receiveShadow = true;\n\n    return cone;\n  };\n\n  /**\n   * Create trees, house and plane\n   * @return { void }\n   */\n  createTerrain = function () {\n    let environment = {},\n      house = {},\n      plane = {};\n\n    plane = createPlane();\n    house = createHouse();\n    environment = new THREE.Object3D();\n    \n    // create trees behind gallery\n    for (let i = 0; i < 200; i = i + 1) {\n      let tree = {},\n        x = GEILDANKEVR.utils.getRandomInteger(-50, 50),\n        z = GEILDANKEVR.utils.getRandomInteger(10, 50); // plant trees only behind the gallery room\n\n      tree = createTree(x, z);\n      environment.add(tree);\n    }\n\n    // create trees left of gallery\n    for (let i = 0; i < 25; i = i + 1) {\n      let tree = {},\n        x = GEILDANKEVR.utils.getRandomInteger(-60, -20),\n        z = GEILDANKEVR.utils.getRandomInteger(-10, 10);\n\n      tree = createTree(x, z);\n      environment.add(tree);\n    }\n\n    // create trees right of gallery\n    for (let i = 0; i < 25; i = i + 1) {\n      let tree = {},\n        x = GEILDANKEVR.utils.getRandomInteger(20, 60),\n        z = GEILDANKEVR.utils.getRandomInteger(-10, 10);\n\n      tree = createTree(x, z);\n      environment.add(tree);\n    }\n\n    environment.add(plane, house);\n\n    GEILDANKEVR.stage.getStage().scene.add(environment);\n  };\n\n  /**\n   * Casts a ray from camera\n   * @param  { object } objects to intersect with\n   * @return { void }\n   */\n  createAnimationCrosshairRaycaster = function (objects) {\n    let camera = GEILDANKEVR.stage.getStage().camera,\n      currentlyIntersecting = false,\n      raycaster = new THREE.Raycaster();\n\n    GEILDANKEVR.stage.registerAnimation('BUTTON_RAYCASTER', () => {\n      let direction = {},\n        intersects = [],\n        origin = {};\n\n      origin = camera.getWorldPosition();\n      direction = camera.getWorldDirection();\n\n      raycaster.set(origin, direction);\n      intersects = raycaster.intersectObjects(objects);\n\n      if (!currentlyIntersecting) {\n        handleIntersection(intersects, 1000);\n      }\n\n      currentlyIntersecting = intersects.length !== 0;\n    });\n  };\n\n  /**\n   * Casts a ray between mouse and camera\n   * @param  { object } objects to intersect with\n   * @return { void }\n   */\n  createAnimationPointerRaycaster = function (objects) {\n    let camera = GEILDANKEVR.stage.getStage().camera,\n      currentlyIntersecting = false,\n      raycaster = new THREE.Raycaster();\n\n    GEILDANKEVR.stage.registerAnimation('BUTTON_RAYCASTER', () => {\n      let intersects = [];\n\n      raycaster.setFromCamera(GEILDANKEVR.utils.getMouse2d(), camera);\n      intersects = raycaster.intersectObjects(objects);\n      if (!currentlyIntersecting) {\n        handleIntersection(intersects, 10);\n      }\n\n      currentlyIntersecting = intersects.length !== 0;\n    });\n  };\n\n  /**\n   * Creates thumbs gallery\n   * @param  { array } singles array representing objects that describe thumbs\n   * @return { object } object group containing thumbs\n   */\n  createContent = function (singles) {\n    let galleryWall = {},\n      minOffset = 0,\n      spaceBetweenThumbs = 0.2,\n      thumbWidth = 2;\n\n    galleryWall = new THREE.Object3D();\n    for (let i = 0, max = singles.length; i < max; i = i + 1) {\n      let params = {},\n        single = {};\n\n      params = {\n        thumbWidth,\n        spaceBetweenThumbs\n      };\n\n      single = createSingleThumb(singles[ i ], i, max, params);\n      galleryWall.add(single);\n    }\n\n    minOffset = -(singles.length - 1) * (thumbWidth + spaceBetweenThumbs);\n\n    galleryWall.scrollOffset = {\n      current: 0,\n      min: minOffset,\n      max: 0\n    };\n\n    return galleryWall;\n  };\n\n  /**\n   * Creates two scrolling interaction fields and positions the properly\n   * @return { object } object group containing navigation\n   */\n  createNavigation = function () {\n    let buttonGroup = {},\n      buttonLeft = {},\n      buttonRight = {};\n\n    buttonGroup = new THREE.Object3D();\n    buttonLeft = createSIF({ direction: 'left' });\n    buttonRight = createSIF({ direction: 'right' });\n    buttonLeft.position.set(-1, 1.2, -1);\n    buttonRight.position.set(1, 1.2, -1);\n\n    buttonGroup.add(buttonLeft, buttonRight);\n\n    createRaycaster([buttonLeft, buttonRight]);\n\n    return buttonGroup;\n  };\n\n  /**\n   * Creates a single thumb\n   * @param  { object } config {url: ''}\n   * @param  { number } index curren thumb's index\n   * @param  { number } count count of all thumbs\n   * @param  { object } params distance parameters {spaceBetweenThumbs: 0.2, thumbWidth: 2}\n   * @return { object } Mesh of the thumb\n   */\n  createSingleThumb = function (config, index, count, params) {\n    let geometry = {},\n      material = {},\n      mesh = {},\n      spaceBetweenThumbs = params.spaceBetweenThumbs,\n      texture = {},\n      thumbWidth = params.thumbWidth,\n      xOffset = 0;\n\n    // Calculation of position.x of each thumb\n    // depending on thumb width, space between the thumbs,\n    // count of thumbs and its index.\n    xOffset = (thumbWidth + spaceBetweenThumbs) * index;\n    geometry = new THREE.BoxGeometry(thumbWidth, thumbWidth, 0.025);\n    texture = createTexture(config.url, 1024);\n    material = new THREE.MeshPhongMaterial({ map: texture });\n    mesh = new THREE.Mesh(geometry, material);\n    mesh.position.set(xOffset, 1.6, -2.45);\n    mesh.castShadow = false;\n    mesh.receiveShadow = false;\n\n    return mesh;\n  };\n\n  /**\n   * Loads texture from url\n   * @param { string } url url of the texture\n   * @param { number } fit size of the object to fit\n   * @return { object } texture\n   */\n  createTexture = function (url, fit) {\n    let repeatX,\n      repeatY,\n      texture = {};\n\n    texture = new THREE.TextureLoader().load(url, function () {\n      if (fit) {\n        repeatX = texture.image.naturalHeight / texture.image.naturalWidth;\n\n        if (repeatX > 1) {\n          repeatY = 1 / repeatX;\n          repeatX = 1;\n          texture.repeat.set(repeatX, repeatY);\n          texture.offset.y = (repeatY - 1) / 2 * -1;\n        } else {\n          repeatY = 1;\n          texture.repeat.set(repeatX, repeatY);\n          texture.offset.x = (repeatX - 1) / 2 * -1;\n        }\n      }\n    });\n\n    if (fit) {\n      texture.wrapT = THREE.RepeatWrapping;\n      texture.wrapS = THREE.RepeatWrapping;\n    } else {\n      texture.wrapT = THREE.ClampToEdgeWrapping;\n      texture.wrapS = THREE.ClampToEdgeWrapping;\n    }\n\n    return texture;\n  };\n\n  /**\n   * Creates wall with given parameters and transparent\n   * window in the middle.\n   * @param { float } wallWidth width of the wall\n   * @param { float } windowWidth width of the window\n   * @param { object } material material for the wall\n   * @param { number } fit size of the object to fit\n   * @return { object } wall\n   */\n  createWallWithWindow = function (wallWidth, windowWidth, material) {\n    let glassPane,\n      sideWidth = (wallWidth - windowWidth) / 2,\n      transparentMaterial = new THREE.MeshBasicMaterial({\n        color: 0x9dcbc7,\n        transparent: true,\n        opacity: 0.3\n      }),\n      wall = new THREE.Object3D(),\n      wallLeft,\n      wallRight;\n\n    wallLeft = new THREE.Mesh(new THREE.BoxGeometry(sideWidth, 2.5, 0.2), material);\n    wallLeft.position.set(-windowWidth / 2 - sideWidth / 2, 0, 0);\n    wallRight = new THREE.Mesh(new THREE.BoxGeometry(sideWidth, 2.5, 0.2), material);\n    wallRight.position.set(windowWidth / 2 + sideWidth / 2, 0, 0);\n    glassPane = new THREE.Mesh(new THREE.BoxGeometry(windowWidth, 2.5, 0.2), transparentMaterial);\n    glassPane.position.set(0, 0, 0);\n\n    wall.add(wallLeft, wallRight, glassPane);\n    return wall;\n  };\n\n  /**\n   * Creates a room for the user.\n   * @param { object } objectGroup three.js object to add meshes to\n   * @param { object } material material for the wall\n   * @return { void }\n   */\n  createRoom = function (objectGroup, material) {\n    let floor,\n      wall1,\n      wall2,\n      wall3;\n\n    wall1 = createWallWithWindow(6, 5, material);\n    wall1.rotation.z = Math.PI;\n    wall1.position.set(0, 2, 1.4);\n\n    wall2 = createWallWithWindow(3, 2.25, material);\n    wall2.rotation.y = Math.PI / 2;\n    wall2.position.set(-3, 2, -0);\n\n    wall3 = createWallWithWindow(3, 2.25, material);\n    wall3.rotation.y = -Math.PI / 2;\n    wall3.position.set(3, 2, -0);\n\n    floor = new THREE.Mesh(new THREE.BoxGeometry(6, 3, 0.3), material);\n    floor.rotation.x = -Math.PI / 2;\n    floor.position.set(0, 0.75, 0);\n\n    objectGroup.add(wall1, wall2, wall3, floor);\n  };\n\n  /**\n   * Creates the room and lightning\n   * @return { object } object group with all room elements\n   */\n  createWorld = function () {\n    let lights = [],\n      objectGroup = {},\n      sky,\n      wallGeometry = new THREE.BoxGeometry(12, 4, 1),\n      wallMaterial,\n      wallMesh;\n\n    objectGroup = new THREE.Object3D();\n\n    wallMaterial = new THREE.MeshPhongMaterial({\n      shininess: 2\n    });\n\n    wallMesh = new THREE.Mesh(wallGeometry, wallMaterial);\n    wallMesh.position.set(0, 2, -3);\n    wallMesh.castShadow = true;\n    wallMesh.receiveShadow = true;\n\n    sky = new THREE.Mesh(new THREE.BoxGeometry(100, 100, 100),\n      new THREE.MeshBasicMaterial({color: 0xabdcfb, side: THREE.BackSide, fog: false}));\n\n    lights[ 0 ] = new THREE.PointLight(0xffffff, 0.75);\n    lights[ 0 ].position.set(0, 3, 0);\n    lights[ 0 ].castShadow = true;\n\n    lights[ 1 ] = new THREE.AmbientLight(0x444444);\n    lights[ 1 ].position.set(0, 0, 0);\n\n    createRoom(objectGroup, wallMaterial);\n    createTerrain();\n\n    objectGroup.add(wallMesh);\n    objectGroup.add(lights[ 0 ], lights[ 1 ], sky);\n\n    return objectGroup;\n  };\n\n\n  /**\n   * Stops scrolling animation for thumbnails, removes it from animation loop\n   * @param  { object } config various parameters for scrolling animation\n   * @return { void }\n   */\n  endThumbAnimation = function (config) {\n    config.object.setMode('idle');\n\n    GEILDANKEVR.stage.deregisterAnimation('THUMBS_SCROLLING');\n  };\n\n\n  /**\n   * Starts scrolling animation for thumbnails\n   * @param  { object } config various parameters for scrolling animation\n   * @return { void }\n   */\n  startThumbAnimation = function (config) {\n    let speed = -0.015 * config.sign;\n\n    GEILDANKEVR.stage.registerAnimation('THUMBS_SCROLLING', () => {\n      let offset = thumbsContainer.scrollOffset,\n        x = thumbsContainer.position.x;\n\n      if (offset.current + speed < offset.max && offset.current + speed > offset.min) {\n        offset.current = offset.current + speed;\n        thumbsContainer.position.x = x + speed;\n        config.object.setMode('scroll');\n      } else {\n        config.object.setMode('error');\n      }\n    });\n  };\n\n  /**\n   * Initialize Scene\n   * @param  { object } stage object\n   * @param  { object } config object\n   * @return { void }\n   */\n  SCOPE.init = function (stage, config) {\n    let isValid = false,\n      scene = {},\n      singles = [],\n      ui = {},\n      world = {};\n\n    isValid = typeof config.container === 'object' &&\n      typeof stage.scene === 'object' &&\n      typeof config.singles === 'object';\n\n    GEILDANKEVR.utils.errorChecker(isValid);\n\n    scene = stage.scene;\n    singles = config.singles;\n\n\n    thumbsContainer = createContent(singles);\n    world = createWorld();\n    ui = createNavigation();\n    createCrosshair();\n\n    scene.fog = new THREE.Fog(0xcccccc, 5, 50);\n    scene.add(thumbsContainer, world, ui);\n  };\n\n  // PRIVATE START\n  SCOPE.createSingleThumb = createSingleThumb;\n  SCOPE.createSIF = createSIF;\n  SCOPE.handleIntersection = handleIntersection;\n  SCOPE.createRaycaster = createRaycaster;\n  SCOPE.endThumbAnimation = endThumbAnimation;\n  SCOPE.startThumbAnimation = startThumbAnimation;\n  SCOPE.createTexture = createTexture;\n  // PRIVATE END\n\n  return SCOPE;\n}());\n","'use strict';\n\nwindow.GEILDANKEVR.content.single = (function () {\n  const DEFAULT_ANIMATION_SPEED = 10,\n    VIDEO_PLAY_BUTTON_ID = 'GEILDANKEVR-video-play';\n\n  let SCOPE = {},\n    addVideoPlayButton,\n    createVRSphere,\n    createVideo,\n    createVideoPlayHandling = {},\n    createVideoSources = {},\n    endAnimation = {},\n    handleOptionalAnimationSpeed = {},\n    handleOptionalClearColor = {},\n    handleOptionalConfig = {},\n    handleOptionalIsAnimation = {},\n    handleOptionalStartRotation = {},\n    handleOptionalVideoMute = {},\n    handleOptionalVideoPoster = {},\n    handleVrDisplayModeChange = {},\n    removeVideo = {},\n    removeVideoPlayButton = {},\n    startAnimation = {},\n    video = null,\n    videoMaterial = null,\n    videoTexture = null;\n\n  /**\n   * Adds a play icon to the stage container\n   * @return { void }\n   */\n  addVideoPlayButton = function () {\n    let button = {},\n      container = {},\n      videoPlayIcon = GEILDANKEVR.assets.getIconPlayWhite();\n\n    button = document.createElement('div');\n    button.setAttribute('id', VIDEO_PLAY_BUTTON_ID);\n    button.style.backgroundImage = 'url(' + videoPlayIcon + ')';\n    button.style.backgroundColor = 'transparent';\n    button.style.backgroundSize = 'contain';\n    button.style.backgroundPosition = 'center center';\n    button.style.backgroundRepeat = 'no-repeat';\n    button.style.content = '';\n    button.style.display = 'block';\n    button.style.position = 'absolute';\n    button.style.top = '50%';\n    button.style.left = '50%';\n    button.style.transform = 'translate(-50%, -50%)';\n    button.style.width = '40px';\n    button.style.height = '40px';\n\n    container = GEILDANKEVR.stage.getStage().container;\n    container.appendChild(button);\n  };\n\n  /**\n   * Creates a sphere and maps a video texture inside.\n   * @param  { object } sources 'url'\n   * @param { string } type media type\n   * @param  { object } container {elementObject}\n   * @param { object } config object\n   * @return { object } THREE.Mesh\n   */\n  createVideo = function (sources, type, container, config) {\n    let geometry = {},\n      isValid = false,\n      mesh = {};\n\n    isValid = typeof sources === 'object' &&\n      typeof type === 'string' &&\n      typeof container === 'object';\n\n    GEILDANKEVR.utils.errorChecker(isValid);\n\n    geometry = new THREE.SphereGeometry(500, 60, 40);\n    video = document.createElement('video');\n\n    video.loop = true;\n    video.setAttribute('webkit-playsinline', 'webkit-playsinline');\n\n    video = createVideoPlayHandling(container);\n    createVideoSources(sources);\n\n    // Handle Video Mute here because it has to be done before video creation\n    if (typeof config.single.optionalConfig === 'object') {\n      handleOptionalVideoMute(config.single.optionalConfig);\n    }\n\n    videoTexture = new THREE.VideoTexture(video);\n    videoTexture.minFilter = THREE.NearestFilter;\n    videoTexture.maxFilter = THREE.NearestFilter;\n    videoTexture.format = THREE.RGBFormat;\n    videoTexture.generateMipmaps = false;\n    videoTexture.wrapS = THREE.ClampToEdgeWrapping;\n    videoTexture.wrapT = THREE.ClampToEdgeWrapping;\n    videoTexture.repeat.set(1, 1);\n\n    geometry.scale(-1, 1, 1);\n\n    videoMaterial = new THREE.MeshBasicMaterial({ map: videoTexture });\n    mesh = new THREE.Mesh(geometry, videoMaterial);\n\n    return mesh;\n  };\n\n  /**\n   * Add autoplay settings for video\n   * @param { object } container {elementObject}\n   * @return { object } video\n   */\n  createVideoPlayHandling = function (container) {\n    if (GEILDANKEVR.mobileDetection.isMobile()) {\n      addVideoPlayButton();\n\n      container.addEventListener('click', function () {\n        removeVideoPlayButton();\n        video.play();\n      });\n    } else {\n      video.play();\n    }\n    return video;\n  };\n\n  /**\n   * Create multiple video sources depending on user config\n   * @param  { object } sources video sources config object\n   * @return { void }\n   */\n  createVideoSources = function (sources) {\n    Object.keys(sources).forEach(function (key) {\n      let obj = sources[key],\n        sourceElement = document.createElement('source');\n\n      sourceElement.setAttribute('src', obj);\n      sourceElement.setAttribute('type', 'video/' + key);\n      video.appendChild(sourceElement);\n    });\n  };\n\n  /**\n   * Creates a VR sphere for 360 images\n   * and returns it.\n   * @param { string } texturePath: path to the texture map\n   * @return { object } THREE.Mesh\n   */\n  createVRSphere = function (texturePath) {\n    let geometry = {},\n      isValid = false,\n      material = {},\n      texture = {},\n      vrSphere = {};\n\n    isValid = typeof texturePath === 'string';\n\n    GEILDANKEVR.utils.errorChecker(isValid);\n\n    geometry = new THREE.SphereGeometry(500, 60, 40);\n\n    texture = new THREE.TextureLoader().load(texturePath);\n    texture.wrapS = THREE.RepeatWrapping;\n    texture.wrapT = THREE.RepeatWrapping;\n    texture.repeat.set(1, 1);\n\n    material = new THREE.MeshBasicMaterial({\n      map: texture\n    });\n\n    vrSphere = new THREE.Mesh(geometry, material);\n    vrSphere.scale.set(-1, 1, 1);\n\n    return vrSphere;\n  };\n\n  /**\n   * End automatic animation\n   * @return { void }\n   */\n  endAnimation = function () {\n    GEILDANKEVR.stage.deregisterAnimation('AUTO_ROTATION');\n  };\n\n  /**\n   * Returns the animation speed, depending on the user config\n   * If there is no user config, DEFAULT_ANIMATION_SPEED is used\n   * @param  { number } animationSpeed config.animationSpeed\n   * @return { number } animationSpeed in degree per second\n   */\n  handleOptionalAnimationSpeed = function (animationSpeed) {\n    // default animation speed in degree per second\n    let animationSpeedDPS = DEFAULT_ANIMATION_SPEED;\n\n    if (animationSpeed && typeof animationSpeed === 'number') {\n      animationSpeedDPS = animationSpeed;\n    }\n\n    return animationSpeedDPS;\n  };\n\n  /**\n   * Handle possible optional configurations\n   * @param  { object } config object\n   * @return { void }\n   */\n  handleOptionalConfig = function (config) {\n    handleOptionalIsAnimation(config);\n    handleOptionalStartRotation(config);\n    handleOptionalClearColor(config);\n    handleOptionalVideoPoster(config);\n  };\n\n  /**\n   * Check if an optional clear color was set\n   * and change renderer if true\n   * @param  { object } config object\n   * @return { void }\n   */\n  handleOptionalClearColor = function (config) {\n    let clearColor = null;\n\n    if (typeof config.clearColor === 'string') {\n      clearColor = config.clearColor.toString(16);\n      clearColor = new THREE.Color(clearColor);\n      GEILDANKEVR.stage.setClearColor(clearColor);\n    }\n  };\n\n  /**\n   * Check if optional animation was activated.\n   * @param  { object } config object\n   * @return { void }\n   */\n  handleOptionalIsAnimation = function (config) {\n    let animationSpeed = 0,\n      isValid = false;\n\n    isValid = typeof config === 'object';\n\n    GEILDANKEVR.utils.errorChecker(isValid);\n\n    animationSpeed = handleOptionalAnimationSpeed(config.animationSpeed);\n\n    if (config.isAnimation === true &&\n       // do not activate animation on movile\n      GEILDANKEVR.mobileDetection.isMobile() === false &&\n       // do not activate animation when vr mode is active\n      GEILDANKEVR.utils.getVrDisplayMode() === false) {\n      startAnimation(animationSpeed);\n    }\n  };\n\n  /**\n   * Check if optional start rotation was set\n   * @param  { object } config object\n   * @return { void }\n   */\n  handleOptionalStartRotation = function (config) {\n    if (typeof config.startRotation === 'number') {\n      GEILDANKEVR.stage.setLookAt(config.startRotation);\n    }\n  };\n\n  /**\n   * Check if video should be muted\n   * @param  { object } config object\n   * @return { void }\n   */\n  handleOptionalVideoMute = function (config) {\n    if (typeof config.videoMuted === 'boolean' &&\n      config.videoMuted === true) {\n      video.muted = true;\n      video.setAttribute('muted', 'true');\n    }\n    if (typeof config.videoMuted === 'boolean' &&\n      config.videoMuted === false) {\n      video.muted = false;\n    }\n  };\n\n  /**\n   * Check if a video poster was set\n   * @param  { object } config object\n   * @return { void }\n   */\n  handleOptionalVideoPoster = function (config) {\n    if (typeof config.videoPoster === 'string') {\n      video.setAttribute('poster', config.videoPoster);\n    }\n  };\n\n  /**\n   * Hand vr display mode change\n   * @return { void }\n   */\n  handleVrDisplayModeChange = function () {\n    if (GEILDANKEVR.utils.getVrDisplayMode() === true) {\n      endAnimation();\n    } else {\n      startAnimation();\n    }\n  };\n\n  /**\n   * Destroys the video, its texture and material\n   * @return { void }\n   */\n  removeVideo = function () {\n    video.pause();\n    video.src = '';\n    video.remove();\n    video = null;\n    videoTexture.dispose();\n    videoMaterial.dispose();\n  };\n\n  /**\n   * Removes the video play icon from the DOM\n   * @return { void }\n   */\n  removeVideoPlayButton = function () {\n    let button = {};\n\n    button = document.getElementById(VIDEO_PLAY_BUTTON_ID);\n    button.parentNode.removeChild(button);\n  };\n\n  /**\n   * Start automatic animation\n   * @param { number } animationSpeed the animation speed in degree per second\n   * @return { void }\n   */\n  startAnimation = function (animationSpeed) {\n    let clock = 0,\n      delta = 0;\n\n    GEILDANKEVR.stage.registerAnimation('AUTO_ROTATION', () => {\n      let stage = GEILDANKEVR.stage.getStage(),\n        y = stage.dolly.rotation.y;\n\n      // has to be called within the render loop\n      // rotates xx degree per second\n      clock = GEILDANKEVR.stage.getStage().clock;\n      delta = clock.getDelta();\n      stage.dolly.rotation.y = y - delta * Math.PI / 180 * animationSpeed;\n    });\n  };\n\n  /**\n   * Creates a 360 degree sphere for videos or images.\n   * @param  { object } stage {camera: {}, controls: {}, manager: {}, scene: {}}\n   * @param  { object } config { mediaType: '', url: '', container: {elementObject} }\n   * @return { void }\n   */\n  SCOPE.init = function (stage, config) {\n    let camera = {},\n      container = {},\n      createObjects = {},\n      isValid = false,\n      mediaObject = {},\n      mediaType = {},\n      scene = {},\n      texture = {};\n\n    isValid = typeof stage.camera === 'object' &&\n      typeof stage.scene === 'object' &&\n      typeof config.container === 'object' &&\n      typeof config.single === 'object' &&\n      typeof config.single.mediaType === 'string';\n\n    GEILDANKEVR.utils.errorChecker(isValid);\n\n    camera = stage.camera;\n    container = config.container;\n    mediaType = config.single.mediaType;\n    scene = stage.scene;\n    texture = config.single.url;\n\n    createObjects = {\n      image: function () {\n        mediaObject = createVRSphere(texture);\n        scene.add(mediaObject);\n      },\n      video: function () {\n        camera.layers.enable(1);\n        mediaObject = createVideo(texture, 'left', container, config);\n        scene.add(mediaObject);\n        mediaObject = createVideo(texture, 'right', container, config);\n        scene.add(mediaObject);\n      }\n    };\n\n    createObjects[mediaType]();\n\n    if (typeof config.single.optionalConfig === 'object') {\n      handleOptionalConfig(config.single.optionalConfig);\n    }\n\n    window.addEventListener('vrdisplaypresentchange', function (e) {\n      handleVrDisplayModeChange(e);\n    });\n  };\n\n  /**\n   * Destroys video, ends animation\n   * @return { void }\n   */\n  SCOPE.destroy = function () {\n    endAnimation();\n    if (video !== null) {\n      removeVideo();\n    }\n  };\n\n  // PRIVATE START\n  SCOPE.endAnimation = endAnimation;\n  SCOPE.handleOptionalAnimationSpeed = handleOptionalAnimationSpeed;\n  SCOPE.handleOptionalStartRotation = handleOptionalStartRotation;\n  SCOPE.removeVideo = removeVideo;\n  SCOPE.startAnimation = startAnimation;\n  SCOPE.createVideoPlayHandling = createVideoPlayHandling;\n  SCOPE.addVideoPlayButton = addVideoPlayButton;\n  // PRIVATE END\n\n  return SCOPE;\n}());\n","'use strict';\n\nwindow.GEILDANKEVR.globalEvents = (function () {\n  let SCOPE = {},\n    handleVrDisplayChange = {};\n\n  handleVrDisplayChange = function (e) {\n    let isValid = false;\n\n    isValid = typeof e === 'object' &&\n    typeof e.detail === 'object' &&\n    typeof e.detail.vrdisplay === 'object' &&\n    typeof e.detail.vrdisplay.isPresenting === 'boolean';\n    GEILDANKEVR.utils.errorChecker(isValid);\n\n    GEILDANKEVR.utils.setVrDisplayMode(e.detail.vrdisplay.isPresenting);\n  };\n\n  window.addEventListener('vrdisplaypresentchange', handleVrDisplayChange);\n\n  // PRIVATE START\n  SCOPE.handleVrDisplayChange = handleVrDisplayChange;\n  // PRIVATE END\n\n  return SCOPE;\n}());\n","'use strict';\n\nwindow.GEILDANKEVR.mobileDetection = (function () {\n  let SCOPE = {};\n\n  /* eslint-disable complexity, max-len, wrap-iife, space-before-function-paren,\n  space-before-blocks, brace-style, keyword-spacing, curly, space-infix-ops,\n  wrap-regex, comma-spacing, semi */\n  /**\n   * [isMobile description]\n   * @return {Boolean} [description]\n   */\n  SCOPE.isMobile = function () {\n    let check = false;\n\n    (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);\n\n    return check;\n  };\n  /* eslint-enable complexity, max-len, wrap-iife, space-before-function-paren,\n  space-before-blocks, brace-style, keyword-spacing, curly, space-infix-ops,\n  wrap-regex, comma-spacing, semi */\n\n  return SCOPE;\n}());\n","'use strict';\n\nwindow.GEILDANKEVR.stage = (function () {\n  const DEFAULT_COLOR_CLEAR = new THREE.Color(0x000000);\n\n  let SCOPE = {},\n    addListeners,\n    animate,\n    createCamera,\n    createCameraDolly,\n    createControls,\n    createRenderer,\n    createScene,\n    createVREffect,\n    createVRManager,\n    getCurrentContainerDimensions,\n    makeContainerFullscreen,\n    onFullscreenChange,\n    onFullscreenEnd,\n    onFullscreenStart,\n    onResize,\n    prepareDocument,\n    requestAnimationFrameId,\n    setCanvasDimensions,\n    stage = {},\n    undoContainerFullscreen,\n    updateQueue = {};\n\n  /**\n   * Add event listeners for resize and vrdisplaypresentchange.\n   * @param { object } container: DOM element of the canvas container\n   * @param { object } camera: THREE.js camera object\n   * @param { object } effect: THREE.js VR effect\n   * @return { void }\n   */\n  addListeners = function (container, camera, effect) {\n    let fullscreenEvents = ['webkitfullscreenchange', 'mozfullscreenchange', 'msfullscreenchange'];\n\n    window.addEventListener('resize', function () {\n      onResize(container, camera, effect);\n    }, true);\n    window.addEventListener('vrdisplaypresentchange', function () {\n      onResize(container, camera, effect);\n    }, true);\n\n    // Bind to fullscreen events.\n    for (let i = 0, max = fullscreenEvents.length; i < max; i = i + 1) {\n      document.addEventListener(\n        fullscreenEvents[i],\n        onFullscreenChange.bind(null, container, camera, effect),\n        true\n      );\n    }\n  };\n\n  /**\n   * Check if app is already in fullscreen mode and\n   * handle fullscreen start and fullscreen end\n   * @param  { object } container object\n   * @param  { object } camera object\n   * @param  { object } effect object\n   * @return { void }\n   */\n  onFullscreenChange = function (container, camera, effect) {\n    if (GEILDANKEVR.utils.isFullscreen()) {\n      onFullscreenStart(container, camera, effect);\n    } else {\n      onFullscreenEnd(container, camera, effect);\n    }\n  };\n\n  /**\n   * Animation loop\n   * @param { number } timestamp: DOMHighResTimeStamp\n   * @param { object } controls: THREE.js VR controls\n   * @param { object } camera: THREE.js camera object\n   * @param { object } manager: WebVRManager object\n   * @param { object } scene: THREE.js scene\n   * @return { void }\n   */\n  animate = function (timestamp, controls, camera, manager, scene) {\n    controls.update();\n    manager.render(scene, camera, timestamp);\n    Object.keys(updateQueue).forEach((key) => {\n      updateQueue[ key ]();\n    });\n    requestAnimationFrameId = requestAnimationFrame(function () {\n      animate(timestamp, controls, camera, manager, scene);\n    });\n  };\n\n  /**\n   * Creates a THREE.js perspective camera\n   * and returns it.\n   * @param { object } cameraContainer: DOM element of the canvas container\n   * @return { object } THREE.PerspectiveCamera | object\n   */\n  createCamera = function (cameraContainer) {\n    let camera,\n      containerRatio = cameraContainer.offsetWidth / cameraContainer.offsetHeight;\n\n    camera = new THREE.PerspectiveCamera(75, containerRatio, 0.1, 10000);\n    return camera;\n  };\n\n  /**\n   * Create a camera dolly for animations and rotation/position setting\n   * @param  { object } camera object\n   * @return { object } dolly THREE.Group object\n   */\n  createCameraDolly = function (camera) {\n    let dolly = {};\n\n    dolly = new THREE.Group();\n    dolly.add(camera);\n    return dolly;\n  };\n\n  /**\n   * Create THREE.js VR controls\n   * and returns them.\n   * @param { object } camera: THREE.js camera object\n   * @return { object } THREE.VRControls | object\n   */\n  createControls = function (camera) {\n    let controls;\n\n    controls = new THREE.VRControls(camera);\n    controls.standing = true;\n    return controls;\n  };\n\n  /**\n   * Create THREE.js WebGL renderer\n   * and returns it.\n   * @return { object } THREE.WebGLRenderer | object\n   */\n  createRenderer = function () {\n    let renderer;\n\n    renderer = new THREE.WebGLRenderer({ antialias: true });\n    renderer.setClearColor(DEFAULT_COLOR_CLEAR, 1);\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.shadowMap.enabled = true;\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\n    return renderer;\n  };\n\n  /**\n   * Creates THREE.js scene\n   * and returns it.\n   * @return { object } THREE.Scene | object\n   */\n  createScene = function () {\n    let scene;\n\n    scene = new THREE.Scene();\n    return scene;\n  };\n\n  /**\n   * Creates THREE.js VR effect\n   * and returns it.\n   * @param {object} renderer: THREE.js renderer\n   * @param {object} container: DOM element of the canvas container\n   * @return { object } THREE.VREffect | object\n   */\n  createVREffect = function (renderer, container) {\n    let effect;\n\n    effect = new THREE.VREffect(renderer);\n    effect.setSize(container.offsetWidth, container.offsetHeight);\n    return effect;\n  };\n\n  /**\n   * Creates a WebVR manager\n   * and returns it.\n   * @param {object} renderer: THREE.js renderer\n   * @param {object} effect: THREE.js VR effect\n   * @param {object} container: DOM element of the canvas container\n   * @return { object } WebVRManager | object\n   */\n  createVRManager = function (renderer, effect, container) {\n    let manager,\n      params = {\n        hideButton: false,\n        isUndistorted: false\n      };\n\n    // container.className += ' webvr-polyfill-fullscreen-wrapper';\n    manager = new WebVRManager(renderer, effect, params, container);\n    return manager;\n  };\n\n  /**\n   * Returns the container dimensions,\n   * depending on wether user is in fullscreen mode or not\n   * @param  { object } container element\n   * @return {object} dimensions.width and dimenstions.height\n   */\n  getCurrentContainerDimensions = function (container) {\n    let dimensions = {};\n\n    dimensions.width = container.offsetWidth;\n    dimensions.height = container.offsetHeight;\n    if (GEILDANKEVR.utils.isFullscreen() && GEILDANKEVR.utils.isLandscapeMode()) {\n      dimensions.width = screen.width;\n      dimensions.height = screen.height;\n    } else if (GEILDANKEVR.utils.isFullscreen() && GEILDANKEVR.utils.isPortraitMode()) {\n      dimensions.width = screen.width;\n      dimensions.height = screen.height;\n    }\n    return dimensions;\n  };\n\n  /**\n   * Add fullscreen styling\n   * @param  { HTMLNode } container element\n   * @return { HTMLNode } container element\n   */\n  makeContainerFullscreen = function (container) {\n    container.style.paddingBottom = '0';\n    container.style.position = 'fixed';\n    container.style.top = '0';\n    container.style.left = '0';\n    container.width = screen.width;\n    container.style.width = screen.width + 'px';\n    container.height = screen.height;\n    container.style.height = screen.height + 'px';\n    container.style.zIndex = '1';\n    return container;\n  };\n\n  /**\n   * Modify canvas wrapper container and canvas\n   * before closing fullscreen mode.\n   * Must be done, because the canvas\n   * was resized to screen width and height\n   * and should be resetted to default state.\n   * @param { object } container: DOM element of the canvas container\n   * @param { object } camera: THREE.js camera object\n   * @param { object } effect: THREE.js VR effect\n   * @return { void }\n   */\n  onFullscreenEnd = function (container, camera, effect) {\n    undoContainerFullscreen(container);\n    setCanvasDimensions(container, container.offsetWidth, container.offsetHeight);\n    onResize(container, camera, effect);\n  };\n\n  /**\n   * Modify canvas wrapper container and canvas\n   * before opening fullscreen mode.\n   * Must be done, because the canvas\n   * has to be resized to screen width and height.\n   * @param { object } container: DOM element of the canvas container\n   * @param { object } camera: THREE.js camera object\n   * @param { object } effect: THREE.js VR effect\n   * @return { void }\n   */\n  onFullscreenStart = function (container, camera, effect) {\n    makeContainerFullscreen(container);\n    setCanvasDimensions(container, screen.width, screen.height);\n    onResize(container, camera, effect);\n  };\n\n  /**\n   * Resizes camera and effect\n   * @param {object} container: DOM element of the canvas container\n   * @param { object } camera: THREE.js camera object\n   * @param {object} effect: THREE.js VR effect\n   * @return { void }\n   */\n  onResize = function (container, camera, effect) {\n    let dimensions = {};\n\n    if (GEILDANKEVR.utils.isFullscreen()) {\n      makeContainerFullscreen(container);\n    }\n    dimensions = getCurrentContainerDimensions(container);\n    effect.setSize(dimensions.width, dimensions.height);\n    camera.aspect = dimensions.width / dimensions.height;\n    camera.updateProjectionMatrix();\n  };\n\n  /**\n   * Prepares the DOM\n   * @return { void }\n   */\n  prepareDocument = function () {\n     // does make touch swipe on mobile in fullscreen possible\n    document.body.style.width = '100%';\n  };\n\n  /**\n   * Set the width of a canvas\n   * contained in the container.\n   * @param { object } container: DOM element of the canvas container\n   * @param { object } width: container width\n   * @param { object } height: container height\n   * @return { void }\n   */\n  setCanvasDimensions = function (container, width, height) {\n    let canvas = container.getElementsByTagName('canvas')[ 0 ];\n\n    canvas.width = width;\n    canvas.style.width = width + 'px';\n    canvas.height = height;\n    canvas.style.height = height + 'px';\n  };\n\n  /**\n   * Remove fullscreen styling\n   * @param  { HTMLNode } container element\n   * @return { HTMLNode } container element\n   */\n  undoContainerFullscreen = function (container) {\n    container.style.removeProperty('padding-bottom');\n    container.style.removeProperty('position');\n    container.style.removeProperty('top');\n    container.style.removeProperty('left');\n    container.style.removeProperty('width');\n    container.style.removeProperty('height');\n    container.style.removeProperty('z-index');\n    return container;\n  };\n\n  /**\n   * Cancels request animation frame\n   * @return { void }\n   */\n  SCOPE.cancelRenderLoop = function () {\n    cancelAnimationFrame(requestAnimationFrameId);\n  };\n\n  /**\n   * Returns stage object\n   * @return { object } stage object\n   */\n  SCOPE.getStage = function () {\n    return stage;\n  };\n\n  /**\n   * Creates and returns a stage,\n   * adds event listeners and starts the animation loop.\n   * @param  { object } container {elementObject}\n   * @param { object } config optional config object\n   * @return { object } stage object\n   */\n  SCOPE.init = function (container, config) {\n    let camera,\n      clock,\n      controls,\n      dolly,\n      effect,\n      isValid,\n      manager,\n      renderer,\n      scene;\n\n    isValid = typeof container === 'object';\n\n    GEILDANKEVR.utils.errorChecker(isValid);\n\n    renderer = createRenderer(config);\n    scene = createScene();\n    camera = createCamera(container);\n    controls = createControls(camera);\n    effect = createVREffect(renderer, container);\n    manager = createVRManager(renderer, effect, container);\n    dolly = createCameraDolly(camera);\n    clock = new THREE.Clock();\n\n    prepareDocument();\n\n    container.appendChild(renderer.domElement);\n    scene.add(dolly);\n\n    stage.renderer = renderer;\n    stage.camera = camera;\n    stage.controls = controls;\n    stage.dolly = dolly;\n    stage.manager = manager;\n    stage.scene = scene;\n    stage.renderer = renderer;\n    stage.clock = clock;\n    stage.container = container;\n\n    requestAnimationFrame(function (timestamp) {\n      animate(timestamp,\n        controls,\n        camera,\n        manager,\n        scene\n      );\n    });\n\n    addListeners(container, camera, effect);\n\n    return stage;\n  };\n\n/**\n * Register an animation, that has to be added to the render loop\n * @param  { string } guid string to describe animation\n * @param  { Function } callback animation function\n * @return { void }\n */\n  SCOPE.registerAnimation = function (guid, callback) {\n    updateQueue[guid] = callback;\n  };\n\n  /**\n   * Deregisters an animation, removes it from the render loop\n   * @param  { string } guid string to describe animation\n   * @return { void }\n   */\n  SCOPE.deregisterAnimation = function (guid) {\n    delete updateQueue[guid];\n  };\n\n  /**\n   * Destroys a scene to clear memory\n   * @return { void }\n   */\n  SCOPE.destroyScene = function () {\n    stage.scene = null;\n    stage.camera = null;\n    stage.controls = null;\n    stage.manager = null;\n    stage.dolly = null;\n    stage.renderer = null;\n  };\n\n  /**\n   * Sets the renderer's clear color\n   * @param { color } color THREE.js color object\n   * @return { void }\n   */\n  SCOPE.setClearColor = function (color) {\n    stage.renderer.clearColor = color;\n  };\n\n  /**\n   * Rotate camera/user dolly around y axis to some degree\n   * @param { number } yRotationDegree degree to rotate user/camera dolly around y axis\n   * @return { void }\n   */\n  SCOPE.setLookAt = function (yRotationDegree) {\n    let yRotationRadian = GEILDANKEVR.utils.degreeToRadians(yRotationDegree);\n\n    stage.dolly.rotation.y = yRotationRadian;\n  };\n\n  // PRIVATE START\n  SCOPE.getCurrentContainerDimensions = getCurrentContainerDimensions;\n  SCOPE.makeContainerFullscreen = makeContainerFullscreen;\n  SCOPE.onFullscreenStart = onFullscreenStart;\n  SCOPE.undoContainerFullscreen = undoContainerFullscreen;\n  // PRIVATE END\n\n  return SCOPE;\n}());\n","'use strict';\n\nwindow.GEILDANKEVR.utils = (function () {\n  let SCOPE = {},\n    createCrosshairRaycaster = {},\n    createPointerRaycaster = {},\n    getOrientation = {},\n    init = {},\n    isVrDisplayMode = false,\n    mouse2d = new THREE.Vector2(),\n    mouse3d = new THREE.Vector3(),\n    onMouseMove = {};\n\n  /**\n   * Creates a Raycaster from Camera\n   * @param  { number } delayTimeout timeout in ms\n   * @param  { object } object to intersect with\n   * @param  { Function } callback function what happens when nothing is intersecting\n   * @return { void }\n   */\n  createCrosshairRaycaster = function (delayTimeout, object, callback) {\n    let camera = {},\n      lookatIntervalId = {},\n      raycaster = {};\n\n    raycaster = new THREE.Raycaster();\n    camera = GEILDANKEVR.stage.getStage().camera;\n\n    lookatIntervalId = window.setInterval(function () {\n      let intersects = [];\n\n      raycaster.set(camera.getWorldPosition(), camera.getWorldDirection());\n      intersects = raycaster.intersectObject(object);\n\n      if (intersects.length === 0) {\n        callback();\n        clearTimeout(delayTimeout);\n        clearInterval(lookatIntervalId);\n      }\n    }, 50);\n  };\n\n  /**\n   * Creates a Raycaster from Pointer and Camera\n   * @param  { number } delayTimeout timeout in ms\n   * @param  { object } object to intersect with\n   * @param  { Function } callback function what happens when nothing is intersecting\n   * @return { void }\n   */\n  createPointerRaycaster = function (delayTimeout, object, callback) {\n    let camera = {},\n      lookatIntervalId = {},\n      raycaster = {};\n\n    raycaster = new THREE.Raycaster();\n    camera = GEILDANKEVR.stage.getStage().camera;\n\n    lookatIntervalId = window.setInterval(function () {\n      let intersects = [];\n\n      raycaster.setFromCamera(mouse2d, camera);\n      intersects = raycaster.intersectObject(object);\n\n      if (intersects.length === 0) {\n        callback();\n        clearTimeout(delayTimeout);\n        clearInterval(lookatIntervalId);\n      }\n    }, 50);\n  };\n\n  /**\n   * Returns cross browser screen.orientation object\n   * @return { object } screen.orientation\n   */\n  getOrientation = function () {\n    let orientation = {};\n\n    orientation = screen.orientation.type ||\n      screen.mozOrientation.type ||\n      screen.msOrientation.type;\n    return orientation;\n  };\n\n  /**\n   * Initialize utils\n   * @return { void }\n   */\n  init = function () {\n    if (GEILDANKEVR.mobileDetection &&\n        GEILDANKEVR.mobileDetection.isMobile() === false) {\n      document.addEventListener('mousemove', onMouseMove, false);\n    }\n  };\n\n  /**\n   * Get Mouse Position on MouseMove\n   * @param  { object } event mousemove event\n   * @return { void }\n   */\n  onMouseMove = function (event) {\n    let camera = GEILDANKEVR.stage.getStage().camera,\n      canvas = GEILDANKEVR.stage.getStage().container,\n      offsetX = GEILDANKEVR.utils.getElementPosition(canvas).x,\n      offsetY = GEILDANKEVR.utils.getElementPosition(canvas).y,\n      viewHeight = GEILDANKEVR.utils.getCanvasDimensions().height,\n      viewWidth = GEILDANKEVR.utils.getCanvasDimensions().width;\n\n    event.preventDefault();\n    // calculate mouse position in normalized device coordinates\n    // (-1 to +1) for both components\n    mouse2d.x = (event.clientX - offsetX) / viewWidth * 2 - 1;\n    mouse2d.y = -(event.clientY - offsetY) / viewHeight * 2 + 1;\n    mouse3d = new THREE.Vector3(mouse2d.x, mouse2d.y, 0.5).unproject(camera);\n  };\n\n  /**\n   * Converts degrees to radians\n   * @param  { number } degrees to convert in radians\n   * @return { number } radians\n   */\n  SCOPE.degreeToRadians = function (degrees) {\n    return degrees * Math.PI / 180;\n  };\n\n  /**\n   * Checks if the argument is not false\n   * @param  { Boolean } isValid argument to be checked\n   * @return { void }\n   */\n  SCOPE.errorChecker = function (isValid) {\n    if (!isValid) {\n      throw new Error('Arguments are not correct.');\n    }\n  };\n\n  /**\n   * Get the canvas dimensions\n   * @return { object } width and height of canvas\n   */\n  SCOPE.getCanvasDimensions = function () {\n    let height = 0,\n      width = 0;\n\n    width = GEILDANKEVR.stage.getStage().container.clientWidth;\n    height = GEILDANKEVR.stage.getStage().container.clientHeight;\n\n    return {\n      height: height,\n      width: width\n    };\n  };\n\n  /**\n   * Returns the offset position of an element\n   * @param  { object } el element to get the offset values from\n   * @return { object } offset x and y of the element\n   */\n  SCOPE.getElementPosition = function (el) {\n    let rect = el.getBoundingClientRect(),\n      scrollLeft = 0,\n      scrollTop = 0;\n\n    scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;\n    scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n    return {\n      x: rect.left + scrollLeft,\n      y: rect.top + scrollTop\n    };\n  };\n\n  /**\n   * Returns a random integer beween both parameters\n   * @param { number } min integer\n   * @param { number } max integer\n   * @return { number } random integer\n   */\n  SCOPE.getRandomInteger = function (min, max) {\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n  };\n\n  /**\n   * Returns a random gauss number\n   * @param { number } median for gauss number\n   * @param { number } variance for gauss number\n   * @param { number } cove for gauss number\n   * @return { number } gauss number\n   */\n  SCOPE.getRandomGauss = function (median, variance, cove) {\n    return variance * Math.pow(Math.random() - 0.5, cove) + median;\n  };\n\n  /**\n   * Returns vr display mode\n   * @return { boolean } vr display mode active true or false\n   */\n  SCOPE.getVrDisplayMode = function () {\n    return isVrDisplayMode;\n  };\n\n  /**\n   * Returns true, if app runs in fullscreen\n   * @return { Boolean } false if app is not in fullscreen\n   */\n  SCOPE.isFullscreen = function () {\n    let fullscreen = false;\n\n    if (document.webkitFullscreenElement !== null &&\n      document.mozFullScreenElement !== null) {\n      fullscreen = true;\n    }\n    return fullscreen;\n  };\n\n  /**\n   * Returns a boolean depending user is in landscape mode or not\n   * @return { Boolean } isLandscapeMode\n   */\n  SCOPE.isLandscapeMode = function () {\n    let isLandscapeMode = false,\n      orientation = getOrientation();\n\n\n    if (orientation === 'landscape-primary' || orientation === 'landscape-secondary') {\n      isLandscapeMode = true;\n    }\n    return isLandscapeMode;\n  };\n\n  /**\n   * Returns a boolean depending user is in portrait mode or not\n   * @return { Boolean } isPortraitMode\n   */\n  SCOPE.isPortraitMode = function () {\n    let isPortraitMode = false,\n      orientation = getOrientation();\n\n\n    if (orientation === 'portrait-primary' || orientation === 'portrait-secondary') {\n      isPortraitMode = true;\n    }\n    return isPortraitMode;\n  };\n\n  /**\n   * Takes an object and two functions with parameters\n   * to handle a user's look at the object\n   * First function and params are executed when user looks at object.\n   * Second function and params are executed when user looks away again.\n   * @param  { object } config object holding the object to check for a look at,\n   * the lookAt function and its arguments and\n   * the lookAway function ant its arguments\n   * @return { void }\n   */\n  SCOPE.handleLookat = function (config) {\n    let delayTimeout,\n      isValid = false;\n\n    isValid = typeof config === 'object' &&\n      typeof config.element === 'object' &&\n      typeof config.lookAt === 'function' &&\n      typeof config.lookAtArguments === 'object' &&\n      typeof config.lookAway === 'function' &&\n      typeof config.lookAwayArguments === 'object';\n\n    GEILDANKEVR.utils.errorChecker(isValid);\n    if (config.delay) {\n      delayTimeout = setTimeout(() => {\n        config.lookAt(config.lookAtArguments);\n      }, config.delay);\n    } else {\n      config.lookAt(config.lookAtArguments);\n    }\n\n    if (GEILDANKEVR.mobileDetection.isMobile() === true) {\n      createCrosshairRaycaster(delayTimeout, config.element.object, function () {\n        config.lookAway(config.lookAwayArguments);\n      });\n    } else {\n      createPointerRaycaster(delayTimeout, config.element.object, function () {\n        config.lookAway(config.lookAwayArguments);\n      });\n    }\n  };\n\n  /**\n   * Sets the vr display mode\n   * @param { boolean } isPresenting event object vrdisplaypresentchange.detail.vrdisplay\n   * @return { void }\n   */\n  SCOPE.setVrDisplayMode = function (isPresenting) {\n    isVrDisplayMode = isPresenting;\n  };\n\n  /**\n   * Returns the Mouse Pointer Vector\n   * @return { Object } Vector2\n   */\n  SCOPE.getMouse2d = function () {\n    return mouse2d;\n  };\n\n  /**\n   * Returns the Mouse Vector in 3d Space\n   * @return { Object } Vector3\n   */\n  SCOPE.getMouse3d = function () {\n    return mouse3d;\n  };\n\n  init();\n\n  return SCOPE;\n}());\n"]}